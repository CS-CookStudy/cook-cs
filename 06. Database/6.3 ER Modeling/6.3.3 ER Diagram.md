# ER 다이어그램 작성법

## 1. ER 다이어그램 개요

### 1.1 정의

**ER 다이어그램(ER Diagram)** 은 개체-관계 모델을 그래픽으로 표현한 도구로, 개체, 속성, 관계를 시각적 기호로 나타낸다.

### 1.2 목적

- **시각적 이해**: 복잡한 데이터 구조를 직관적으로 표현
- **의사소통**: 설계자와 사용자 간 원활한 소통
- **설계 검증**: 논리적 오류 발견 및 수정
- **문서화**: 데이터베이스 설계의 표준 문서

---

## 2. 기본 표기법 (Chen 표기법)

### 2.1 개체 표현

#### 강한 개체

```
┌─────────────┐
│    학생     │  ← 사각형으로 표현
└─────────────┘
```

#### 약한 개체

```
┌══════════════┐
║   부양가족    ║  ← 이중 사각형으로 표현
└══════════════┘
```

### 2.2 속성 표현

#### 일반 속성

```
    ○ 이름
     │
┌─────────────┐
│    학생     │
└─────────────┘
     │
    ○ 주소
```

#### 키 속성 (기본 키)

```
    ⊙ 학번      ← 밑줄이 있는 타원
     │
┌─────────────┐
│    학생     │
└─────────────┘
```

#### 다중값 속성

```
    ◉ 전화번호   ← 이중 타원
     │
┌─────────────┐
│    학생     │
└─────────────┘
```

#### 복합 속성

```
        주소
         │
    ┌────┼────┐
    │    │    │
   시도  구  동
         │
   ┌─────────────┐
   │    학생     │
   └─────────────┘
```

#### 도출 속성

```
    ⋯○ 나이      ← 점선 타원
     │
┌─────────────┐
│    학생     │
└─────────────┘
     │
    ○ 생년월일
```

### 2.3 관계 표현

#### 일반 관계

```
┌─────────┐      ◇수강◇     ┌─────────┐
│  학생   │──────────────────│  과목   │
└─────────┘                  └─────────┘
```

#### 식별 관계 (약한 개체와의 관계)

```
┌─────────┐      ◈소속◈     ┌══════════┐
│  직원   │══════════════════║  부양가족 ║
└─────────┘                  └══════════┘
```

### 2.4 대응수 표현

```
┌─────────┐  1   ◇수강◇   N ┌─────────┐
│  학생   │──────────────────│  과목   │
└─────────┘                  └─────────┘
```

### 2.5 참여도 표현

#### 부분 참여 (단일선)

```
┌─────────┐      ◇관리◇     ┌─────────┐
│  교수   │──────────────────│ 프로젝트 │
└─────────┘                  └─────────┘
```

#### 전체 참여 (이중선)

```
┌─────────┐      ◇소속◇     ┌─────────┐
│  사원   │══════════════════│  부서   │
└─────────┘                  └─────────┘
```

---

## 3. 대안 표기법

### 3.1 Crow's Foot 표기법

#### 기본 구조

```
학생 ────<──── 수강 ────>──── 과목
     1        M         N        1
```

#### 대응수 표현

- **1**: 직선
- **M**: 까마귀발 (crow's foot) ─<
- **?**: 원 ○ (선택적 참여)

#### 예시

```
부서 ────── 사원
    1      M

학생 ──○<──── 수강 ────○< 과목
    1       M         N      1
```

### 3.2 Martin 표기법 (IDEF1X)

#### 식별 관계

```
┌─────────┐      ┌─────────┐
│  주문   │──────│주문상세 │
├─────────┤      ├─────────┤
│주문번호*│      │주문번호*│ (FK)
│고객ID   │      │상품ID*  │
│주문일자 │      │수량     │
└─────────┘      │단가     │
                 └─────────┘
```

#### 비식별 관계

```
┌─────────┐      ┌─────────┐
│  부서   │┄┄┄┄┄┄│  사원   │
├─────────┤      ├─────────┤
│부서코드*│      │사원번호*│
│부서명   │      │부서코드 │ (FK)
└─────────┘      │사원명   │
                 │입사일   │
                 └─────────┘
```

---

## 4. ER 다이어그램 작성 과정

### 4.1 1단계: 요구사항 분석

```
대학교 시스템 요구사항:
- 학생은 여러 과목을 수강할 수 있다
- 교수는 여러 과목을 강의할 수 있다
- 각 과목은 한 명의 교수가 담당한다
- 학생의 수강 정보에는 성적이 포함된다
```

### 4.2 2단계: 개체 식별

```
식별된 개체:
- 학생 (Student)
- 교수 (Professor)
- 과목 (Course)
```

### 4.3 3단계: 속성 정의

```
학생: 학번(PK), 이름, 주소, 전화번호
교수: 교수번호(PK), 이름, 전공, 연구실
과목: 과목코드(PK), 과목명, 학점, 시간
```

### 4.4 4단계: 관계 설정

```
관계:
- 수강: 학생 ↔ 과목 (M:N, 속성: 성적)
- 강의: 교수 ↔ 과목 (1:N)
```

### 4.5 5단계: ER 다이어그램 작성

```
     ○이름              ○이름              ○과목명
     │                  │                  │
     ⊙학번              ⊙교수번호          ⊙과목코드
     │       1    M     │    1      N     │
┌─────────┐    ◇수강◇  │  ◇강의◇  ┌─────────┐
│  학생   │────────────│─────────────│  과목   │
└─────────┘            │             └─────────┘
     │                 │                  │
     ○주소         ┌─────────┐           ○학점
     │             │  교수   │
     ○전화번호     └─────────┘
                        │
                       ○전공
                        │
                       ○연구실
```

---

## 5. 작성 규칙과 지침

### 5.1 명명 규칙

#### 개체명

- **명사 사용**: 학생, 교수, 과목
- **단수형 사용**: Student (Students ✗)
- **의미가 명확**: 축약어 지양

#### 속성명

- **명사 사용**: 이름, 주소, 전화번호
- **개체명 반복 지양**: 학생이름 → 이름
- **일관성 유지**: 동일한 의미는 같은 이름 사용

#### 관계명

- **동사 사용**: 수강, 강의, 소속
- **능동형 선호**: 관리 (관리됨 ✗)
- **의미가 명확**: 모호한 표현 지양

### 5.2 배치 규칙

#### 개체 배치

- **중앙 배치**: 중요한 개체를 중심에
- **관련성 고려**: 관련된 개체들을 가까이
- **대칭성 유지**: 시각적으로 균형감 있게

#### 속성 배치

- **키 속성**: 개체 위쪽에 배치
- **중요 속성**: 키 속성 다음 순서
- **선 교차 최소화**: 복잡성 감소

#### 관계 배치

- **직선 연결**: 가능한 한 직선으로
- **교차점 최소화**: 선들의 교차 줄이기
- **레이블 명확**: 관계명이 잘 보이게

---

## 6. 복잡한 구조 표현

### 6.1 삼진 관계 표현

```
        ┌─────────┐
        │  학생   │
        └─────────┘
             │
             │
    ┌────────◇지도────────┐
    │                     │
┌─────────┐           ┌─────────┐
│  교수   │           │  과목   │
└─────────┘           └─────────┘

지도 관계: 특정 교수가 특정 학생을 특정 과목에서 지도
```

### 6.2 순환 관계 표현

```
        ┌─────────┐
        │  사원   │◄─────┐
        └─────────┘      │
             │           │
             └───◇관리───┘

사원이 다른 사원을 관리하는 관계
역할명: 상사-부하
```

### 6.3 복합 속성의 상세 표현

```
              주소
               │
        ┌──────┼──────┐
        │      │      │
       시도    구     동
        │      │      │
   ┌─────────────────────┐
   │       학생          │
   └─────────────────────┘
        │           │
    우편번호     상세주소
```

### 6.4 다중값 속성 처리

```
방법 1: 별도 개체로 분리
┌─────────┐  1    M  ┌─────────────┐
│  학생   │──────────│  전화번호   │
└─────────┘          └─────────────┘

방법 2: 관계로 표현
┌─────────┐     ◇보유◇     ◉전화번호
│  학생   │─────────────────────○
└─────────┘
```

---

## 7. 설계 검증 및 최적화

### 7.1 일관성 검사

#### 명명 일관성

```
✅ 올바른 예:
- 학생.학번, 성적.학번 (동일 속성명)
- 수강, 강의 (동사형 관계명)

❌ 잘못된 예:
- 학생.학번, 성적.학생번호 (불일치)
- 학생-과목, 교수가르침과목 (혼재)
```

#### 구조적 일관성

```
✅ 올바른 예:
모든 개체는 최소 하나의 키 속성 보유

❌ 잘못된 예:
키 속성이 없는 개체 존재
```

### 7.2 완전성 검사

#### 누락 요소 확인

- **필수 개체**: 모든 중요 개체 포함
- **핵심 관계**: 주요 업무 관계 모두 표현
- **키 속성**: 모든 개체의 식별자 정의

#### 과도한 요소 제거

- **불필요한 개체**: 업무와 무관한 개체
- **중복 관계**: 같은 의미의 관계 통합
- **무의미한 속성**: 사용되지 않는 속성

---

## 8. 실전 예제

### 8.1 도서관 시스템 ER 다이어그램

```
     ○이름              ○제목              ○이름
     │                  │                  │
     ⊙회원번호          ⊙ISBN             ⊙저자ID
     │       1    M     │    M      N     │
┌─────────┐    ◇대출◇  │  ◇저술◇  ┌─────────┐
│  회원   │────────────│─────────────│  저자   │
└─────────┘            │             └─────────┘
     │      대출일자,    │                  │
     ○주소   반납일자    │                 ○국적
     │          ┌─────────┐
     ○전화번호  │  도서   │
                └─────────┘
                     │
                    ○출판사
                     │
                    ○출판일
```

### 8.2 온라인 쇼핑몰 ER 다이어그램

```
     ○이름                              ○상품명
     │                                  │
     ⊙고객ID                           ⊙상품ID
     │       1    M                M   │
┌─────────┐    ◇주문◇──────────◇포함◇──┌─────────┐
│  고객   │────────────────────────────│  상품   │
└─────────┘    주문일자,              └─────────┘
     │         총금액    1        M         │
     ○주소              │        │        ○가격
     │              ┌─────────┐  │         │
     ○전화번호      │  주문   │──┘        ○재고수량
                    └─────────┘
                         │
                        ⊙주문번호
```

---
