# 정규화 vs 반정규화

## 1. 반정규화(Denormalization)
> 데이터베이스 `성능 향상`과 개발운영의 단순화를 위해 중복, 통합, 분리 등을 수행하는 데이터 모델링 기법

### 1-1. 사용 이유

- 데이터 무결성이 깨질 위험이 있음에도 아래와 같은 상황에 반정규화를 수행
    1. 데이터를 조회할 때 디스크 I/O량이 많아서 성능이 저하되는 경우
    2. 경로가 너무 멀어 조인으로 인한 성능저하가 예상되는 경우
    3. 칼럼을 계산하여 읽을 떄 성능이 저하 되는 경우

### 1-2. 반정규화 사용 경우

- 자주 사용되는 테이블에 접근(Access)하는 프로세스의 수가 많고 항상 일정한 범위만을 조회하는 경우
- 테이블에 대량의 데이터가 있고 대량의 데이터 범위를 자주 처리하는 경우에 처리범위를 일정하게 줄이지 않으면 성능을 보장할 수 없을 경우
- 통계성 프로세스에 의해 통계 정보를 필요로 할 때 별도의 통계테이블(반정규화 테이블)을 생성
- 테이블에 지나치게 많은 조인(JOIN)이 걸려 데이터를 조회하는 작업이 기술적으로 어려울 경우 

### 1-3. 반정규화 기법

1. 계산된 칼럼 추가
   - 프로그램을 통해서 총 주문금액, 평균주문 금액 등을 미리 계산하고 결과를 특정 컬럼에 추가
   
2. 테이블 수직 분할
   - 칼럼단위의 테이블을 디스크 I/O를 분산처리 하기 위해 테이블을 1:1로 분리하여 성능향상
   - 트랜잭션의 처리되는 유형을 파악이 선행되어야 함
   
3. 테이블 수평 분할
    - 하나의 테이블에 있는 값을 기준으로 테이블을 분해하는 것

4. 테이블 병합
    - 1:1 관계의 테이블을 하나의 테이블로 병합하여 성능향상
    - 1:N 관계의 테이블을 병합하여 성능을 향상(데이터 중복이 발생하는 단점이 있음)
    - 슈터 타입과 서브 타입 관계가 발생하면 테이블을 통합하여 성능향상


## 2. 정규화 vs 반정규화
| 구분    | 정규화 (Normalization)            | 반정규화 (Denormalization)         |
| ----- | ------------------------------ | ------------------------------ |
| 목적    | 데이터 중복 최소화, 무결성 유지             | 성능 향상, 조회 속도 개선                |
| 중점    | 데이터 중복 제거, 이상현상(삽입, 삭제, 갱신) 방지 | 데이터 중복 허용, 복잡한 조인 연산 감소        |
| 장점    | 데이터 일관성 유지, 저장 공간 효율적 사용       | 쿼리 성능 개선, 시스템 응답 시간 단축         |
| 단점    | 조인 연산 증가로 조회 성능 저하 가능          | 데이터 중복으로 인한 무결성 문제 및 관리 복잡도 증가 |
| 사용 시점 | 설계 초기 단계, 데이터 무결성이 중요한 경우      | 대용량 조회, 빈번한 읽기 작업이 많은 경우       |
| 설계 방향 | 테이블 분해와 관계 설정                  | 테이블 병합 또는 중복 컬럼 추가             |
