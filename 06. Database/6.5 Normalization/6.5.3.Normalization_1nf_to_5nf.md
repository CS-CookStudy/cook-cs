# 정규화 단계 (Normalization 1NF ~ 5NF)
    
    > 기본 정규형
    1. 제 1정규형 (1NF, First Noraml Form)
    2. 제 2정규형(2NF, Second Normal Form)
    3. 제 3정규형(3NF, Third Normal Form)
    4. 보이스-코드(BCNF, Boyce-Codd Normal Form)

    > 고급 정규형
    5. 제 4정규형(4NF, Fourth Normal Form)
    6. 제 5정규형(5NF, Fifth Normal Form)

<br>

#### - 과정 설명을 위한 초기 전체 테이블 예시
| 주문번호 | 고객명 | 상품명    | 수량  | 납품업체   | 납품지역   |
| ---- | --- | ------ | --- | ------ | ------ |
| 001  | 홍길동 | 베개, 이불 | 2,1 | A사, B사 | 서울, 부산 |
| 002  | 이영희 | 이불     | 1   | B사     | 부산     |
| 003  | 최민수 | 이불     | 2   | B사     | 부산     |

## 1. 제 1정규형 (1NF, First Noraml Form)
> 테이블의 컬럼이 원자값(하나의 값)을 갖도록 테이블을 분해하는 것

### 1-1. 1NF 위반된 예시
| 주문번호 | 고객명 | 상품명    | 
| ---- | --- | ------ | 
| 001  | 홍길동 | 베개, 이불 | 
| 002  | 이영희 | 이불     |
| 003  | 최민수 | 이불     | 

- 상품명 컬럼에 2개의 값이 들어 있음

### 1-2. 1NF 만족하는 예시
| 주문번호 | 고객명 | 상품명 | 
| ---- | --- | --- |
| 001  | 홍길동 | 베개  |
| 001  | 홍길동 | 이불  |
| 002  | 이영희 | 이불  | 
| 003  | 최민수 | 이불  |

- 각 셀마다 하나의 값만 존재
- 중복되더라도 데이터가 정규화되어 원자값을 가짐


## 2. 제 2정규형(2NF, Second Normal Form)
> 제 1 정규화를 진행한 테이블에 대해 완전 함수 종속을 만족하도록 테이블을 분해하는 것
- `부분 함수 종속` 제거

## 2-1. 2NF 위반(부분 함수 종속)
| 주문번호 | 상품명 | 고객명 |
| ---- | --- | --- |
| 001  | 베개  | 홍길동 |
| 001  | 이불  | 홍길동 |
| 002  | 이불  | 이영희 |

- 기본키가 (주문번호, 상품명) 복합키라 가정했을 때,  
- 고객명은 주문번호에만 종속 → `부분 함수 종속 발생`


## 2-2. 테이블 분해

- 주문 테이블

    | 주문번호 | 고객명 |
    | ---- | --- |
    | 001  | 홍길동 |
    | 002  | 이영희 |
    | 003  | 최민수 |

- 주문 상세 테이블

    | 주문번호 | 상품명 | 수량 | 납품업체 | 납품지역 |
    | ---- | --- | -- | ---- | ---- |
    | 001  | 베개  | 2  | A사   | 서울   |
    | 001  | 이불  | 1  | B사   | 부산   |
    | 002  | 이불  | 1  | B사   | 부산   |
    | 003  | 이불  | 2  | B사   | 부산   |


## 3. 제 3정규형(3NF, Third Normal Form)
> 제 2정규화를 진행한 테이블에 대해 이행적 종속을 없애도록 테이블을 분해하는 것

### 3-1. 3NF 위반

| 주문번호 | 고객명 | 상품명 | 납품업체 | 납품지역 |
| ---- | --- | --- | ---- | ---- |
| 001  | 홍길동 | 베개  | A사   | 서울   |
| 001  | 홍길동 | 이불  | B사   | 부산   |
| 002  | 이영희 | 이불  | B사   | 부산   |
| 003  | 최민수 | 이불  | B사   | 부산   |

- 기본 키 : 주문번호 + 상품명
- 주문번호 + 상품명 → 납품업체는 직접적인 함수 종속
- 그러니! 납품업체가 결정되면, 그에 따라 납품지역이 결정
⇒ 즉, `납품업체 → 납품지역`이라는 또 다른 함수 종속이 존재

### 3-2. 테이블 분해(이행적 종속관계 제거)

- 납품업체 테이블
    
    | 납품업체 | 납품지역 |
    | ---- | ---- |
    | A사   | 서울   |
    | B사   | 부산   |

- 주문 상세 테이블
    
    | 주문번호 | 상품명 | 수량 | 납품업체 |
    | ---- | --- | -- | ---- |
    | 001  | 베개  | 2  | A사   |
    | 001  | 이불  | 1  | B사   |
    | 002  | 이불  | 1  | B사   |
    | 003  | 이불  | 2  | B사   |



## 4. 보이스-코드(BCNF, Boyce-Codd Normal Form)
>제 3정규화를 진행한 테이블에 대해 모든 결정자가 후보키가 되도록 테이블을 분해하는 것

### 4-1. 용어 정리
- 후보키(Candidate Key) : 유일하게 튜플을 식별하며, 속성을 하나 제거하면 유일성을 상실하는 키
- 결정자(Determinant) : 어떤 값을 기준으로 다른 값을 결정할 수 있는 속성

### 4-2. BCNF 위반
> 결정자(왼쪽에 있는 속성)가 후보키가 아닌 경우(최소성, 유일성 만족하지 X)

| 고객명 | 제품명 | 회사명 | 회사주소    |
| --- | --- | --- | ------- |
| 홍길동 | 베개  | A사  | 서울시 강남구 |
| 이영희 | 베개  | A사  | 서울시 강남구 |
| 박지민 | 베개  | A사  | 서울시 강남구 |

- 회사명 = A사인 데이터가 여러 행에 반복적으로 존재
- 회사명만으로는 튜플을 유일하게 구분(홍길동의 튜플인지, 이영희의 튜플인지)할 수 없음
⇒ 즉, 회사명 → 회사주소 : 함수 종속관계는 맞지만 후보키는 아님

### 4-3. 테이블 분리

- 고객 정보 테이블

    | 고객명 | 제품명 | 회사명 |
    | --- | --- | --- |
    | 홍길동 | 베개  | A사  |
    | 이영희 | 베개  | A사  |
    | 박지민 | 베개  | A사  |


- 회사 정보 테이블

    | 회사명 | 회사주소    |
    | --- | ------- |
    | A사  | 서울시 강남구 |


## 5. 제 4정규형(4NF, Fourth Normal Form)
> 제 4정규화는 BCNF를 만족하는 테이블에 대해, 다치 종속을 제거하는 것

### 5-1. 다치 종속이란?
- 같은 테이블 내의 독립적인 두 개 이상의 컬럼이 또 다른 컬럼에 종속되는 것을 말함
- 다치 종속 관계를 `A->>B`로 표기

### 5-2. 다치 종속 예시
| 주문번호 | 상품명 | 납품업체 |
| ---- | --- | ---- |
| 001  | 베개  | A사   |
| 001  | 베개  | C사   |
- 상품 하나에 여러 납품 업체가 존재

### 5-3. 테이블 분리

- 주문-상품 테이블

    | 주문번호 | 상품명 |
    | ---- | --- |
    | 001  | 베개  |

- 주문-납품업체 테이블

    | 주문번호 | 납품업체 |
    | ---- | ---- |
    | 001  | A사   |
    | 001  | C사   |


## 6. 제 5정규형(5NF, Fifth Normal Form)
> 4정규형을 만족하는 테이블에 대해 조인 종속을 제거하는 것

### 6-1. 조인 종속이란?
- 하나의 릴레이션(테이블)을 여러 개의 릴레이션으로 분리했다가, 다시 조인했을 때 데이터 손실이 없지만 `원래 없던 데이터`가 생기는 것

### 6-2. 5NF 위반

1. 하나의 릴레이션

    | 고객명 | 제품명 | 회사명 |
    | --- | --- | --- |
    | 홍길동 | 베개  | A사  |
    | 홍길동 | 이불  | B사  |
    | 이영희 | 베개  | A사  |
    | 이영희 | 이불  | A사  |

2. 분해
  - 고객-제품

    | 고객명 | 제품명 |
    | --- | --- |
    | 홍길동 | 베개  |
    | 홍길동 | 이불  |
    | 이영희 | 베개  |
    | 이영희 | 이불  |

  - 고객-회사
      
    | 고객명 | 회사명 |
    | --- | --- |
    | 홍길동 | A사  |
    | 홍길동 | B사  |
    | 이영희 | A사  |

  - 제품-회사
      
    | 제품명 | 회사명 |
    | --- | --- |
    | 베개  | A사  |
    | 이불  | A사  |
    | 이불  | B사  |

3. 다시 조인 후 전체 테이블
- 실제로 존재하지 않는 조합까지 생성

    | 고객명 | 제품명 | 회사명  |
    | --- | --- | ---- |
    | 홍길동 | 베개  | A사  |
    | 홍길동 | 베개  | B사 ❌ |
    | 홍길동 | 이불  | A사  |
    | 홍길동 | 이불  | B사  |
    | 이영희 | 베개  | A사  |
    | 이영희 | 베개  | B사 ❌ |
    | 이영희 | 이불  | A사  |
    | 이영희 | 이불  | B사  |


### 6-3. 5NF 
- 3개의 테이블로 분리하지 않고, 원래의 3항 관계를 유지

| 고객명 | 제품명 | 회사명 |
| --- | --- | --- |
| 홍길동 | 베개  | A사  |
| 홍길동 | 이불  | B사  |
| 이영희 | 베개  | A사  |
| 이영희 | 이불  | A사  |


> 테이블을 분해할 때는 분해 후 다시 조인해도 정보가 손실이 없고 불필요한 데이터가 안 생기는지 확인 필요