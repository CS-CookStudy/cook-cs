# 라우팅 알고리즘 - RIP, OSPF, BGP

## 1. 라우팅 프로토콜 분류

### 용도별 분류

```
IGP (Interior Gateway Protocol) - AS 내부용
├─ RIP: 소규모 네트워크
└─ OSPF: 중대규모 네트워크

EGP (Exterior Gateway Protocol) - AS 간 연결
└─ BGP: 인터넷 백본
```

### 알고리즘별 분류

- **Distance Vector**: 거리와 방향만 알고 있음 (RIP)
- **Link State**: 전체 네트워크 지도를 가지고 있음 (OSPF)
- **Path Vector**: 경로 전체를 기록 (BGP)

## 2. RIP (Routing Information Protocol)

### RIP 특징

- **홉 카운트**를 거리 척도로 사용
- **최대 15홉** 제한 (소규모 네트워크용)
- **30초마다 라우팅 테이블 전송**
- Distance Vector 알고리즘 사용

### RIP 동작 방식

```
1. 이웃 라우터들과 라우팅 정보 교환
2. 더 짧은 경로가 있으면 라우팅 테이블 업데이트
3. 30초마다 정기적으로 정보 전송
4. 장애 발생 시 홉 카운트 16(무한대)으로 광고
```

### RIP 장단점

**장점:**

- 설정 간단
- 작은 메모리/CPU 사용
- 구현 쉬움

**단점:**

- 최대 15홉 제한
- 느린 수렴 시간
- 홉 수만 고려 (대역폭 무시)

## 3. OSPF (Open Shortest Path First)

### OSPF 특징

- **Link State 알고리즘** 사용
- **Dijkstra 알고리즘**으로 최단 경로 계산
- **대역폭을 고려한 코스트** 계산
- **에리어(Area) 개념**으로 확장성 제공

### OSPF 동작 방식

```
1. LSA(Link State Advertisement) 교환으로 토폴로지 학습
2. 모든 라우터가 동일한 토폴로지 데이터베이스 구축
3. Dijkstra 알고리즘으로 최단 경로 트리 계산
4. 변화가 있을 때만 업데이트 전송
```

### OSPF 에리어 구조

```
┌─────────────────────────────────────┐
│           Backbone Area 0           │ ← 모든 에리어의 중심
└──────────────────┬──────────────────┘
                   │
         ┌─────────┼─────────┐
     ┌───▼───┐ ┌───▼───┐ ┌───▼───┐
     │Area 1 │ │Area 2 │ │Area 3 │ ← 일반 에리어들
     └───────┘ └───────┘ └───────┘
```

### OSPF 장단점

**장점:**

- 빠른 수렴
- 대역폭 고려한 최적 경로
- 확장성 좋음 (에리어 분할)
- 루프 없음

**단점:**

- 복잡한 설정
- 높은 메모리/CPU 요구
- 소규모 네트워크에는 과도

## 4. BGP (Border Gateway Protocol)

### BGP 특징

- **AS(Autonomous System) 간 라우팅** 프로토콜
- **Path Vector 알고리즘** 사용
- **정책 기반 라우팅** 지원
- **인터넷 백본의 표준** 프로토콜

### BGP 동작 방식

```
1. 이웃 AS와 TCP 연결 수립
2. AS 경로 정보를 포함한 라우팅 정보 교환
3. 정책에 따라 경로 선택 및 광고
4. AS 경로 루프 방지 (자신의 AS 번호가 있으면 거부)
```

### BGP 경로 선택 기준

```
우선순위 순서:
1. Weight (Cisco 전용)
2. Local Preference (높을수록 우선)
3. Local Origin (내부 생성 경로 우선)
4. AS Path Length (짧을수록 우선)
5. Origin Code (IGP > EGP > Incomplete)
6. MED (Multi-Exit Discriminator, 낮을수록 우선)
7. 이웃 타입 (eBGP > iBGP)
8. IGP 메트릭 (낮을수록 우선)
```

### BGP 타입

**eBGP (External BGP):**

- 서로 다른 AS 간 연결
- 직접 연결된 이웃과만 피어링

**iBGP (Internal BGP):**

- 같은 AS 내부 라우터 간
- 모든 라우터와 풀 메쉬 연결 필요

### BGP 장단점

**장점:**

- 정책 기반 라우팅
- 확장성 매우 좋음
- 루프 방지 (AS Path)
- 인터넷 표준

**단점:**

- 매우 복잡한 설정
- 느린 수렴
- 높은 관리 복잡도

## 5. 라우팅 프로토콜 비교

| 구분         | RIP             | OSPF               | BGP         |
| ------------ | --------------- | ------------------ | ----------- |
| **용도**     | 소규모 네트워크 | 중대규모 네트워크  | AS 간 연결  |
| **알고리즘** | Distance Vector | Link State         | Path Vector |
| **메트릭**   | 홉 카운트       | 대역폭 기반 코스트 | 정책 기반   |
| **수렴속도** | 느림            | 빠름               | 매우 느림   |
| **확장성**   | 낮음 (15홉)     | 높음 (에리어)      | 매우 높음   |
| **복잡도**   | 낮음            | 중간               | 매우 높음   |
| **표준화**   | RFC 2453        | RFC 2328           | RFC 4271    |

## 6. 실무 활용

### 네트워크 규모별 선택

```
소규모 (10-50대):
└─ RIP 또는 정적 라우팅

중규모 (50-500대):
└─ OSPF

대규모/ISP:
├─ 내부: OSPF
└─ 외부: BGP
```

### 일반적인 구성

```
인터넷
   │ (BGP)
┌──▼────┐
│  ISP  │  (BGP + OSPF)
└───┬───┘
    │      (정적 라우팅 또는 BGP)
┌───▼────┐
│기업본사 │ (OSPF)
└───┬────┘
    │      (RIP 또는 정적)
┌───▼────┐
│  지사   │
└────────┘
```
