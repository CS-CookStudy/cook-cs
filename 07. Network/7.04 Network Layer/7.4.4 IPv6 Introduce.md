# IPv6 개요

## 1. IPv6 기본 개념

### IPv6란?

- **Internet Protocol version 6**: 차세대 인터넷 프로토콜
- **128비트 주소 체계** (IPv4는 32비트)
- **약 340경 개의 주소** 제공 (3.4 × 10^38)
- IPv4의 주소 고갈 문제 해결

### IPv6 등장 배경

```
IPv4 주소 고갈:
- 전체 주소: 약 43억 개 (2^32)
- 실제 사용 가능: 약 36억 개
- 2011년 IANA 주소 풀 고갈
- 2019년 RIPE NCC 마지막 /22 할당

IPv6 필요성:
- IoT 기기 급증
- 모바일 기기 확산
- 클라우드 서비스 증가
- NAT 없는 End-to-End 통신
```

## 2. IPv6 주소 구조

### 주소 길이와 표기법

```
IPv4: 32비트 = 4바이트
192.168.1.1

IPv6: 128비트 = 16바이트
2001:0db8:85a3:0000:0000:8a2e:0370:7334
```

### IPv6 주소 표기 규칙

**기본 표기:**

```
2001:0db8:85a3:0000:0000:8a2e:0370:7334
```

**압축 규칙:**

```
1. 앞자리 0 생략:
   2001:0db8:85a3:0000:0000:8a2e:0370:7334
   → 2001:db8:85a3:0:0:8a2e:370:7334

2. 연속된 0 그룹을 ::로 압축 (한 번만 가능):
   2001:db8:85a3:0:0:8a2e:370:7334
   → 2001:db8:85a3::8a2e:370:7334

3. 최대 압축 예시:
   2001:0000:0000:0000:0000:0000:0000:0001
   → 2001::1
```

### IPv6 주소 구성

```
┌──────────────────────┬───────────────────────┐
│    네트워크 프리픽스    │      인터페이스 ID     │
│       (64비트)        │       (64비트)        │
└──────────────────────┴───────────────────────┘
    │                        │
    └── 라우팅에 사용          └── 호스트 식별에 사용
```

## 3. IPv6 주소 타입

### 유니캐스트 (Unicast)

**Global Unicast Address (공인 주소)**

```
형식: 2000::/3 (2000-3FFF)
예시: 2001:db8:85a3::8a2e:370:7334
용도: 인터넷에서 라우팅 가능한 주소
```

**Unique Local Address (사설 주소)**

```
형식: fc00::/7 (fc00-fdff)
예시: fd12:3456:789a::1
용도: 내부 네트워크용 (IPv4의 사설 IP와 유사)
```

**Link-Local Address**

```
형식: fe80::/10 (fe80-febf)
예시: fe80::1
용도: 같은 링크 내에서만 통신
특징: 자동 구성, 라우터 통과 불가
```

### 멀티캐스트 (Multicast)

```
형식: ff00::/8 (ff00-ffff)
예시: ff02::1 (모든 노드)
     ff02::2 (모든 라우터)
용도: 일대다 통신 (브로드캐스트 대체)
```

### 애니캐스트 (Anycast)

- 여러 인터페이스가 같은 주소 공유
- 가장 가까운 노드로 패킷 전달
- 로드 밸런싱과 이중화에 활용

## 4. IPv6 헤더 구조

### IPv6 헤더 vs IPv4 헤더

```
IPv4 헤더: 20~60바이트 (가변)
IPv6 헤더: 40바이트 (고정)

IPv6에서 제거된 필드:
- Header Length (고정 크기)
- Identification, Flags, Fragment Offset (단편화 처리 변경)
- Header Checksum (하위 계층에서 처리)
- Options (확장 헤더로 분리)
```

### IPv6 기본 헤더

```
┌─────────────┬───────────────┬───────────────────────┐
│   Version   │ Traffic Class │      Flow Label       │
│   (4비트)    │    (8비트)    │        (20비트)        │
├─────────────┴───────────────┼───────────────────────┤
│   Payload Length (16비트)    │       Reserved        │
├─────────────┬───────────────┴───────────────────────┤
│ Next Header │              Hop Limit                │
│   (8비트)    │               (8비트)                 │
├─────────────┴───────────────────────────────────────┤
│                   Source Address                    │
│                      (128비트)                       │
├─────────────────────────────────────────────────────┤
│                 Destination Address                 │
│                      (128비트)                       │
└─────────────────────────────────────────────────────┘
```

## 5. IPv6의 주요 특징

### 확장된 주소 공간

- **128비트 주소**: 사실상 무제한 주소
- **계층적 구조**: 효율적인 라우팅
- **NAT 불필요**: End-to-End 연결성

### 단순화된 헤더

- **고정 크기**: 40바이트로 고정
- **빠른 처리**: 라우터 성능 향상
- **확장 헤더**: 필요시에만 추가

### 자동 구성 (Auto-configuration)

```
SLAAC (Stateless Address Auto-configuration):
1. Link-Local 주소 자동 생성
2. 라우터 광고 수신
3. Global 주소 자동 구성
4. 중복 주소 검사 (DAD)
```

### 보안 강화

- **IPSec 필수**: IPv6에서 IPSec 내장
- **인증 헤더**: 데이터 무결성 보장
- **암호화**: 기본적인 보안 제공

## 6. IPv6 vs IPv4 비교

| 항목             | IPv4            | IPv6              |
| ---------------- | --------------- | ----------------- |
| **주소 길이**    | 32비트          | 128비트           |
| **주소 개수**    | 43억 개         | 340경 개          |
| **헤더 크기**    | 20~60바이트     | 40바이트          |
| **체크섬**       | 있음            | 없음              |
| **단편화**       | 라우터에서 처리 | 송신자만 처리     |
| **브로드캐스트** | 있음            | 없음 (멀티캐스트) |
| **자동 구성**    | DHCP 필요       | SLAAC 지원        |
| **보안**         | 선택사항        | IPSec 내장        |

## 7. IPv6 전환 기술

### 듀얼 스택 (Dual Stack)

```
┌─────────────┐
│ 애플리케이션  │
├─────────────┤
│ IPv4 | IPv6 │ ← 두 프로토콜 동시 지원
├─────────────┤
│   네트워크   │
└─────────────┘
```

### 터널링 (Tunneling)

```
IPv6 over IPv4 터널:
IPv6 패킷을 IPv4 패킷 안에 캡슐화하여 전송

예시: 6to4, Teredo
```

### 변환 (Translation)

```
NAT64/DNS64:
IPv6 전용 클라이언트가 IPv4 서버와 통신
```
