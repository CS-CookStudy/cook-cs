# 7.9 네트워크 보안

# 무선 네트워크 보안 (WEP, WPA, WPA2, WPA3)

## 무선 네트워크 보안이 필요한 이유
- 무선(Wi-Fi)은 유선과 달리 **전파가 공중으로 노출**되어 있어 누구든지 접근 가능
- 따라서 **데이터 도청, 변조, 위조, 불법 접속**을 방지하기 위해 강력한 암호화 및 인증 기술이 필요

---

# 보안 방식의 발전 과정 요약

| 보안 방식    | 주요 암호화      | 인증 방식         | 출시 연도 | 보안 수준       |
| -------- | ----------- | ------------- | ----- | ----------- |
| **WEP**  | RC4 (고정 키)  | 없음            | 1997  | ❌ 매우 취약     |
| **WPA**  | TKIP (동적 키) | PSK 또는 802.1X | 2003  | ⚠️ 임시 개선    |
| **WPA2** | AES-CCMP    | PSK 또는 802.1X | 2004  | ✅ 보편적 기준    |
| **WPA3** | AES-GCMP    | **SAE**       | 2018  | 🔐 최신 최고 수준 |

</br>

---

### 🔸 WEP (Wired Equivalent Privacy)
> 초창기 무선 보안 프로토콜, 유선과 비슷한 수준의 보안을 목표로 함

* **암호화 방식**: RC4 스트림 암호화 + 고정 Initialization Vector (IV)
* **문제점**

  * IV가 **24bit**로 너무 짧아서 **재사용됨**
  * **패킷 스니핑**으로 몇 분 만에 키를 해독 가능
  * **인증 없음**, **무결성 검증 부실**
* **대표적 공격**: Aircrack-ng, MITM, Evil Twin, Replay 공격
* ❌ **보안이 거의 없는 수준**이라 현재는 사용 금지

---

### 🔸 WPA (Wi-Fi Protected Access)
> WEP의 취약점을 임시 개선한 방식

* **암호화 방식**: **TKIP (Temporal Key Integrity Protocol)** 사용
  * 패킷마다 **임시 키**를 동적으로 생성하여 키 재사용을 방지 -> 보안성 향상
* **인증 방식**: PSK (Pre-Shared Key) 또는 EAP (기업 환경)
* **보안 개선**: 메시지 무결성, 키 길이 증가, IV 무작위화
* **한계점**:

  * 여전히 **RC4 기반** → 구조적 한계 존재
  * 오늘날 기준에서는 **더 이상 안전하지 않음**

---

### 🔸 WPA2 (Wi-Fi Protected Access 2)
> WPA의 후속 버전, 무선 네트웨크 보안에서 가장 널리 사용되는 표준

* **암호화**: **AES 기반 CCMP (Counter Mode CBC-MAC Protocol)**

* **인증**:

  * **WPA2-Personal**: 비밀번호 기반 PSK
  * **WPA2-Enterprise**: 802.1X + RADIUS + EAP 인증

* **장점**:

  * AES 사용으로 강력한 암호화
  * CCMP로 데이터 무결성까지 보장
* **단점**:

  * **브루트포스 공격 가능** (PSK 짧거나 단순할 경우)
  * **KRACK 공격**: 4-way handshake 과정에서의 키 재사용 문제

---

### 🔸 WPA3 (Wi-Fi Protected Access 3)
> WPA2의 후속 표준, 2018년에 발표된 최신 무선 네트워크 보안 프로토콜

* **인증**: **SAE (Simultaneous Authentication of Equals)**

  * Diffie-Hellman을 기반으로 한 **서로 대등한 인증 절차**
  * 4-way handshake를 대체 → KRACK 공격 차단
* **암호화**: AES-GCMP or 192bit suite (기업용)
* **보안성**:

  * 오프라인 사전 공격 차단 (dictionary 공격 방지)
  * Perfect Forward Secrecy 제공
  * 공개 Wi-Fi 암호화: **OWE (Opportunistic Wireless Encryption)**
* **모드**:

  * WPA3-Personal
  * WPA3-Enterprise (최대 192bit 암호화 제공)
* **단점**:

  * 기기 호환성 이슈 (특히 구형 장비)
  * 연결 속도 문제

</br>

---

### WPA2 vs WPA3 비교

| 항목              | WPA2          | WPA3             |
| --------------- | ------------- | ---------------- |
| 암호화             | AES-CCMP      | AES-GCMP         |
| 인증 방식           | PSK 또는 EAP    | **SAE (PSK 대체)** |
| 오프라인 공격         | 가능 (PSK 유출 시) | 차단               |
| KRACK 공격        | 취약            | 해결               |
| 공개 Wi-Fi 보안     | 없음            | **OWE 제공**       |
| Forward Secrecy | 없음            | 있음               |
| 호환성             | 대부분 장치 지원     | 일부 최신 장치 필요      |

---

###  동작 방식 도식화 (WPA3 기준)

```
   [ 사용자 ]                                 [ AP (Router) ]
       │                                              │
       │       ① SAE 암호기반 교환 (공동 비밀 생성)     │
       │<──────────────────────────────────────────>│
       │                                              │
       │       ② 세션 키 도출 (AES 암호키)             │
       │──────────────────────────────────────────>│
       │                                              │
       │       ③ 암호화된 통신 시작 (AES-GCMP 사용)     │
       │<──────────────────────────────────────────>│
```

---

### 실제 사례

* **기업/기관 무선 보안**: WPA2-Enterprise or WPA3-Enterprise
* **가정용 공유기**: WPA2-Personal or WPA3-Personal
* **공공장소 공개 Wi-Fi**: WPA3에서 OWE 적용 가능 (단, 지원 장비 한정)
* **문제점**:

  * **Wi-Fi 비밀번호 공유 위험**
  * **Evil Twin 공격**: 가짜 AP를 통한 MITM
  * **공개 와이파이**: 암호화 없이 평문 전송 → 스니핑 가능

---

### 추가 개념들

* **TKIP vs CCMP vs GCMP**

  * TKIP: WPA / RC4 기반 (더 이상 사용 금지)
  * CCMP: WPA2 / AES 기반
  * GCMP: WPA3 / AES 기반, 더 빠르고 안전함

* **TKIP (Temporal Key Integrity Protocol)**
> WPA에서 사용된 암호화 프로토콜로, WEP의 보안 취약점을 해결하기 위해 도입

  * RC4 암호화 알고리즘을 사용하면서, 패킷마다 임시 키를 생성하여 WEP의 고정 키 문제를 해결
  * WPA2로 대체되었으며, 더 이상 권장되지 않음

* **CCMP (Counter Mode with Cipher Block Chaining Message Authentication Code Protocol)**
> WPA2에서 사용되는 암호화 프로토콜로, TKIP를 대체하기 위해 등장

  * AES 블록 암호화를 기반으로 동작
  * CCMP는 AES 암호화를 사용하여 WEP와 TKIP의 보안 문제를 해결
  * WPA2 및 WPA3에서 사용되며, 무선 네트워크의 표준 암호화 방식으로 자리 잡음

* **SAE (Simultaneous Authentication of Equals)**
> WPA3에서 사용되는 **핸드세이크 방식**, 보다 강력한 키 교환을 제공

  * 패스워드 기반 PAKE (Password Authenticated Key Exchange)
  * 브루트 포스 공격에 대한 저항력을 강화하여, WPA2에서 발생하던 딕셔너리 공격 문제를 해결
  * WPA3에서 널리 사용되며, WPA2의 취약점을 보완하는 역할

* **OWE (Opportunistic Wireless Encryption)**

  * 공개 와이파이에서도 개인당 **1:1 암호화 채널 형성**
  * 단, **인증은 없음** → MITM 방지에는 미흡